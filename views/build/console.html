<ul class="nav nav-tabs">
  <li ng-repeat="phase in phases" class="phase phase-[[ phase ]]"
     ng-class="{ disabled: job.phases[phase].commands.length === 0 }">
    <a ng-href="[[job.phases[phase].commands.length === 0 ? '' : '#phase-' + phase]]" data-toggle="tab">
      <i class="fa fa-gear fa-light fa-spin loading-icon" ng-show="loading"></i>
      <i class="fa [[ job.phases[phase].exitCode === 0 ? 'fa-check-circle success-text' : 'fa-exclamation-circle failure-text' ]] ng-hide" ng-show="!loading"></i>
      [[ phase ]]
    </a>
  </li>
</ul>

<div class="tab-content phase-content">
  <div ng-repeat="phase in phases" id="phase-[[ phase ]]" class="tab-pane">
    <div class="meta" ng-show="job.phases[phase].commands.length">
      Duration <time class="duration" datetime="[[ job.phases[phase].finished ]]" since="[[ job.phases[phase].started ]]" duration="[[ job.phases[phase].duration ]]"></time>
      Exit Code <span class="exit-status" ng-show="job.phases[phase].exitCode">[[ job.phases[phase].exitCode ]]</span>
    </div>
    
    <div class="commands">
      <div ng-repeat="command in job.phases[phase].commands"
         ng-class="{ comment: command.comment }"
         class="command plugin-[[ command.plugin ]]">
        <div class="title" ng-click="command.collapsed = !command.collapsed">
          <span class="prompt">[[ command.comment ? '#' : '$' ]]</span> <span class="command-text">[[ command.command ]]</span> <i class="fa fa-plus plus" ng-show="command.collapsed"></i>
          <span class="inner-meta pull-right">
            <span class="plugin">[[ command.plugin ]]</span>
            <time datetime="[[ command.started ]]" since="[[ command.started ]]" duration="[[ command.duration ]]"></time>
            <span class="exit-status" toggle="tooltip" title="exit code" ng-show="job.phases[phase].exitCode">[[ job.phases[phase].exitCode ]]</span>
          </span>
        </div>
        <pre class="job-output" ng-hide="command.collapsed" raw-html="command.merged | ansi"></pre>
      </div>
    </div>
  </div>
</div>
