{% extends "base.html" %}

{% block extra_head %}
<link rel="stylesheet" href="/stylesheets/css/config.css">
<link rel="stylesheet" href="/stylesheets/css/bootstrap-switch.css"/>
{% endblock %}
{% block bodyContent %}
{% include "config/boot-badge.html" %}
<script id="collaborator-loading" type="text/template" class="template">
  <tr>
    <td>
      <p>Loading collaborators...</p>
    </td>
  </tr>
</script>
<script id="collaborator-table-row" type="text/template" class="template">
  <tr>
    <td><img src="<%= gravatar %>" /></td>
    <td><%= email %></td>
    <td>
      <% if (owner) { %>
      Owner
      <% } else { %>
      <a data-toggle="modal" href="#confirmRemoveCollaborator">
        <i class="icon-remove" id="<%= uuid %>" alt="remove"></i>
      </a>
      <% } %>
    </td>
  </tr>
</script>
<script id="webhook-none" type="text/template" class="template">
  <tr>
    <td>
      <p>No webhooks configured.</p>
    </td>
  </tr>
</script>
<script id="webhook-loading" type="text/template" class="template">
  <tr>
    <td>
      <p>Loading webhooks...</p>
    </td>
  </tr>
</script>
<script id="deactivate-project.html" type="text/ng-template" class="template">
</script>
<script id="deactivate-loading" type="text/template" class="template">
  <tr>
    <td>
      <p>Loading config...</p>
    </td>
  </tr>
</script>
<div class="span12 ng-cloak" ng-app="config" ng-controller="Config"
     data-repo-config='{{ repo | json_encode() | raw }}'
     data-panel-data='{{ panelData | json_encode() | raw }}'>
  <a href="#build-badge-modal" data-toggle="modal" class="badge-link pull-right">Build Badge</a>
  <h3>Configuration - <a href="/{{display_name}}/" class="header-emphasis">{{display_name}}</a></h3>
  <p>
    <div class="tabbable tabs-left">
      <ul class="nav nav-tabs">
        {% for panel in panels %}
        <li {% if loop.first %}class="active"{% endif %}>
          <a href="#{{panel.id}}" data-toggle="tab">{{panel.title}}</a>
        </li>
        {% endfor %}
      </ul>
      <div class="tab-content">
        <div id="notify" class="hide span8">
          <button type="button" class="close" ng-click="hideMessage()">&times;</button>
          <span class="message"></span>
        </div>
        <div id="loading" class="hide span8">
          <img src="/images/spinner.gif" class="spinner"/>
          [[ loadingMessage ]]
        </div>
        {% for panel in panels %}
        <div id="{{panel.id}}" class="tab-pane" ng-controller="{{panel.controller}}">
        {% autoescape false %}
        {{ panel.contents }}
        {% endautoescape %}
        </div>
        {% endfor %}
        <div id="collaborators" class="tab-pane active" ng-controller="CollaboratorsCtrl">
          {% include "config/collaborators.html" %}
        </div>
        <div id="github_config" class="tab-pane" ng-controller="GithubCtrl">
          {% include "config/github.html" %}
        </div>
        <div id="heroku" class="tab-pane" ng-controller="HerokuCtrl">
          {% include "config/heroku.html" %}
        </div>
        <div id="webhooks" class="tab-pane" ng-controller="WebhooksCtrl">
          {% include "config/webhooks.html" %}
        </div>
        <div id="deactivate" class="tab-pane" ng-controller="DeactivateCtrl">
          {% include "config/deactivate.html" %}
        </div>
      </div>
    </div>
  </p>
</div>
  <script src="/javascripts/lib/bootstrap-switch.js"></script>
<script src='/javascripts/pages/config.js'></script>
{% for panel in panels %}
<script src="{{ panel.script_path }}"></script>
{% endfor %}
{% endblock %}
